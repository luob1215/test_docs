"use strict";(self.webpackChunkdeno_docs=self.webpackChunkdeno_docs||[]).push([[6506],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>c});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},M="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),M=u(n),g=i,c=M["".concat(s,".").concat(g)]||M[g]||d[g]||o;return n?a.createElement(c,r(r({ref:t},p),{},{components:n})):a.createElement(c,r({ref:t},p))}));function c(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=g;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[M]="string"==typeof e?e:i,r[1]=l;for(var u=2;u<o;u++)r[u]=n[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},28879:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var a=n(87462),i=(n(67294),n(3905));const o={},r="API server with Firestore (Firebase)",l={unversionedId:"tutorials/tutorial-firebase",id:"tutorials/tutorial-firebase",title:"API server with Firestore (Firebase)",description:"Firebase is a platform developed by Google for creating mobile and web",source:"@site/deploy/tutorials/tutorial-firebase.md",sourceDirName:"tutorials",slug:"/tutorials/tutorial-firebase",permalink:"/deploy/tutorials/tutorial-firebase",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"deployTutorialsHome",previous:{title:"API server with FaunaDB",permalink:"/deploy/tutorials/tutorial-faunadb"},next:{title:"Simple HTTP server",permalink:"/deploy/tutorials/tutorial-http-server"}},s={},u=[{value:"Overview",id:"overview",level:2},{value:"Concepts",id:"concepts",level:2},{value:"Deploy is browser-like",id:"deploy-is-browser-like",level:3},{value:"Firebase uses XHR",id:"firebase-uses-xhr",level:3},{value:"Firebase auth",id:"firebase-auth",level:3},{value:"Setup Firebase",id:"setup-firebase",level:2},{value:"Write the application",id:"write-the-application",level:2},{value:"Create a Project in Deno Deploy",id:"create-a-project-in-deno-deploy",level:2},{value:"Deploy the application",id:"deploy-the-application",level:2}],p={toc:u},M="wrapper";function d(e){let{components:t,...o}=e;return(0,i.kt)(M,(0,a.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"api-server-with-firestore-firebase"},"API server with Firestore (Firebase)"),(0,i.kt)("p",null,"Firebase is a platform developed by Google for creating mobile and web\napplications. You can persist data on the platform using Firestore. In this\ntutorial let's take a look at how we can use it to build a small API that has\nendpoints to insert and retrieve information."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#overview"},"Overview")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#concepts"},"Concepts")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#setup-firebase"},"Setup Firebase")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#write-the-application"},"Write the application")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#deploy-the-application"},"Deploy the application"))),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"We are going to build an API with a single endpoint that accepts ",(0,i.kt)("inlineCode",{parentName:"p"},"GET")," and\n",(0,i.kt)("inlineCode",{parentName:"p"},"POST")," requests and returns a JSON payload of information:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'# A GET request to the endpoint without any sub-path should return the details\n# of all songs in the store:\nGET /songs\n# response\n[\n  {\n    title: "Song Title",\n    artist: "Someone",\n    album: "Something",\n    released: "1970",\n    genres: "country rap",\n  }\n]\n\n# A GET request to the endpoint with a sub-path to the title should return the\n# details of the song based on its title.\nGET /songs/Song%20Title # \'%20\' == space\n# response\n{\n  title: "Song Title"\n  artist: "Someone"\n  album: "Something",\n  released: "1970",\n  genres: "country rap",\n}\n\n# A POST request to the endpoint should insert the song details.\nPOST /songs\n# post request body\n{\n  title: "A New Title"\n  artist: "Someone New"\n  album: "Something New",\n  released: "2020",\n  genres: "country rap",\n}\n')),(0,i.kt)("p",null,"In this tutorial, we will be:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Creating and setting up a\n",(0,i.kt)("a",{parentName:"li",href:"https://console.firebase.google.com/"},"Firebase Project"),"."),(0,i.kt)("li",{parentName:"ul"},"Using a text editor to create our application."),(0,i.kt)("li",{parentName:"ul"},"Creating a ",(0,i.kt)("a",{parentName:"li",href:"https://gist.github.com/"},"gist"),' to "host" our application.'),(0,i.kt)("li",{parentName:"ul"},"Deploying our application on ",(0,i.kt)("a",{parentName:"li",href:"https://dash.deno.com/"},"Deno Deploy"),"."),(0,i.kt)("li",{parentName:"ul"},"Testing our application using ",(0,i.kt)("a",{parentName:"li",href:"https://curl.se/"},"cURL"),".")),(0,i.kt)("h2",{id:"concepts"},"Concepts"),(0,i.kt)("p",null,"There are a few concepts that help in understanding why we take a particular\napproach in the rest of the tutorial, and can help in extending the application.\nYou can skip ahead to ",(0,i.kt)("a",{parentName:"p",href:"#setup-firebase"},"Setup Firebase")," if you want."),(0,i.kt)("h3",{id:"deploy-is-browser-like"},"Deploy is browser-like"),(0,i.kt)("p",null,"Even though Deploy runs in the cloud, in many aspects the APIs it provides are\nbased on web standards. So when using Firebase, the Firebase APIs are more\ncompatible with the web than those that are designed for server run times. That\nmeans we will be using the Firebase web libraries in this tutorial."),(0,i.kt)("h3",{id:"firebase-uses-xhr"},"Firebase uses XHR"),(0,i.kt)("p",null,"Firebase uses a wrapper around Closure's\n",(0,i.kt)("a",{parentName:"p",href:"https://google.github.io/closure-library/api/goog.net.WebChannel.html"},"WebChannel"),"\nand WebChannel was originally built around\n",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest"},(0,i.kt)("inlineCode",{parentName:"a"},"XMLHttpRequest")),".\nWhile WebChannel supports the more modern ",(0,i.kt)("inlineCode",{parentName:"p"},"fetch()")," API, current versions of\nFirebase for the web do not uniformly instantiate WebChannel with ",(0,i.kt)("inlineCode",{parentName:"p"},"fetch()"),"\nsupport, and instead use ",(0,i.kt)("inlineCode",{parentName:"p"},"XMLHttpRequest"),"."),(0,i.kt)("p",null,"While Deploy is browser-like, it does not support ",(0,i.kt)("inlineCode",{parentName:"p"},"XMLHttpRequest"),".\n",(0,i.kt)("inlineCode",{parentName:"p"},"XMLHttpRequest"),' is a "legacy" browser API that has several limitations and\nfeatures that would be difficult to implement in Deploy, which means it is\nunlikely that Deploy will ever implement that API.'),(0,i.kt)("p",null,"So, in this tutorial we will be using a limited ",(0,i.kt)("em",{parentName:"p"},"polyfill")," that provides enough\nof the ",(0,i.kt)("inlineCode",{parentName:"p"},"XMLHttpRequest")," feature set to allow Firebase/WebChannel to communicate\nwith the server."),(0,i.kt)("h3",{id:"firebase-auth"},"Firebase auth"),(0,i.kt)("p",null,"Firebase offers quite ",(0,i.kt)("a",{parentName:"p",href:"https://firebase.google.com/docs/auth"},"a few options"),"\naround authentication. In this tutorial we are going to be using email and\npassword authentication."),(0,i.kt)("p",null,"When a user is logged in, Firebase can persist that authentication. Because we\nare using the web libraries for Firebase, persisting the authentication allows a\nuser to navigate away from a page and not need to re-log in when returning.\nFirebase allows authentication to be persisted in local storage, session storage\nor none."),(0,i.kt)("p",null,"In a Deploy context, it is a little different. A Deploy deployment will remain\n\"active\" meaning that in-memory state will be present from request to request on\nsome requests, but under various conditions a new deployment can be started up\nor shutdown. Currently, Deploy doesn't offer any persistence outside of\nin-memory allocation. In addition it doesn't currently offer the global\n",(0,i.kt)("inlineCode",{parentName:"p"},"localStorage")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"sessionStorage"),", which is what is used by Firebase to store\nthe authentication information."),(0,i.kt)("p",null,"In order to reduce the need to re-authenticate but also ensure that we can\nsupport multiple-users with a single deployment, we are going to use a polyfill\nthat will allow us to provide a ",(0,i.kt)("inlineCode",{parentName:"p"},"localStorage")," interface to Firebase, but store\nthe information as a cookie in the client."),(0,i.kt)("h2",{id:"setup-firebase"},"Setup Firebase"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://firebase.google.com/"},"Firebase")," is a feature rich platform. All the\ndetails of Firebase administration are beyond the scope of this tutorial. We\nwill cover what it needed for this tutorial."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Create a new project under the\n",(0,i.kt)("a",{parentName:"p",href:"https://console.firebase.google.com/"},"Firebase console"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a web application to your project. Make note of the ",(0,i.kt)("inlineCode",{parentName:"p"},"firebaseConfig"),"\nprovided in the setup wizard. It should look something like the below. We\nwill use this later:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},'var firebaseConfig = {\n  apiKey: "APIKEY",\n  authDomain: "example-12345.firebaseapp.com",\n  projectId: "example-12345",\n  storageBucket: "example-12345.appspot.com",\n  messagingSenderId: "1234567890",\n  appId: "APPID",\n};\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Under ",(0,i.kt)("inlineCode",{parentName:"p"},"Authentication")," in the administration console for, you will want to\nenable the ",(0,i.kt)("inlineCode",{parentName:"p"},"Email/Password")," sign-in method.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"You will want to add a user and password under ",(0,i.kt)("inlineCode",{parentName:"p"},"Authentication")," and then\n",(0,i.kt)("inlineCode",{parentName:"p"},"Users")," section, making note of the values used for later.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add ",(0,i.kt)("inlineCode",{parentName:"p"},"Firestore Database")," to your project. The console will allow you to setup\nin ",(0,i.kt)("em",{parentName:"p"},"production mode")," or ",(0,i.kt)("em",{parentName:"p"},"test mode"),". It is up to you how you configure this,\nbut ",(0,i.kt)("em",{parentName:"p"},"production mode")," will require you to setup further security rules.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a collection to the database named ",(0,i.kt)("inlineCode",{parentName:"p"},"songs"),". This will require you to add\nat least one document. Just set the document with an ",(0,i.kt)("em",{parentName:"p"},"Auto ID"),"."))),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Note")," depending on the status of your Google account, there maybe other setup\nand administration steps that need to occur."),(0,i.kt)("h2",{id:"write-the-application"},"Write the application"),(0,i.kt)("p",null,"We want to create our application as a JavaScript file in our favorite editor."),(0,i.kt)("p",null,"The first thing we will do is import the ",(0,i.kt)("inlineCode",{parentName:"p"},"XMLHttpRequest")," polyfill that Firebase\nneeds to work under Deploy as well as a polyfill for ",(0,i.kt)("inlineCode",{parentName:"p"},"localStorage")," to allow the\nFirebase auth to persist logged in users:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'import "https://deno.land/x/xhr@0.1.1/mod.ts";\nimport { installGlobals } from "https://deno.land/x/virtualstorage@0.1.0/mod.ts";\ninstallGlobals();\n')),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\u2139\ufe0f we are using the current version of packages at the time of the writing of\nthis tutorial. They may not be up-to-date and you may want to double check\ncurrent versions.")),(0,i.kt)("p",null,"Because Deploy has a lot of the web standard APIs, it is best to use the web\nlibraries for Firebase under deploy. Currently v9 is in still in beta for\nFirebase, so we will use v8 in this tutorial:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'import firebase from "https://cdn.skypack.dev/firebase@8.7.0/app";\nimport "https://cdn.skypack.dev/firebase@8.7.0/auth";\nimport "https://cdn.skypack.dev/firebase@8.7.0/firestore";\n')),(0,i.kt)("p",null,"We are also going to use ",(0,i.kt)("a",{parentName:"p",href:"https://deno.land/x/oak"},"oak")," as the middleware\nframework for creating the APIs, including middleware that will take the\n",(0,i.kt)("inlineCode",{parentName:"p"},"localStorage")," values and set them as client cookies:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'import {\n  Application,\n  Router,\n  Status,\n} from "https://deno.land/x/oak@v7.7.0/mod.ts";\nimport { virtualStorage } from "https://deno.land/x/virtualstorage@0.1.0/middleware.ts";\n')),(0,i.kt)("p",null,"Now we need to setup our Firebase application. We will be getting the\nconfiguration from environment variables we will setup later under the key\n",(0,i.kt)("inlineCode",{parentName:"p"},"FIREBASE_CONFIG")," and get references to the parts of Firebase we are going to\nuse:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const firebaseConfig = JSON.parse(Deno.env.get("FIREBASE_CONFIG"));\nconst firebaseApp = firebase.initializeApp(firebaseConfig, "example");\nconst auth = firebase.auth(firebaseApp);\nconst db = firebase.firestore(firebaseApp);\n')),(0,i.kt)("p",null,"We are also going to setup the application to handle signed in users per\nrequest. So we will create a map of users that we have previously signed in in\nthis deployment. While in this tutorial we will only ever have one signed in\nuser, the code can easily be adapted to allow clients to sign-in individually:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const users = new Map();\n")),(0,i.kt)("p",null,"Let's create our middleware router and create three different middleware\nhandlers to support ",(0,i.kt)("inlineCode",{parentName:"p"},"GET")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"POST")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"/songs")," and a ",(0,i.kt)("inlineCode",{parentName:"p"},"GET")," of a specific song\non ",(0,i.kt)("inlineCode",{parentName:"p"},"/songs/{title}"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const router = new Router();\n\n// Returns any songs in the collection\nrouter.get("/songs", async (ctx) => {\n  const querySnapshot = await db.collection("songs").get();\n  ctx.response.body = querySnapshot.docs.map((doc) => doc.data());\n  ctx.response.type = "json";\n});\n\n// Returns the first document that matches the title\nrouter.get("/songs/:title", async (ctx) => {\n  const { title } = ctx.params;\n  const querySnapshot = await db.collection("songs").where("title", "==", title)\n    .get();\n  const song = querySnapshot.docs.map((doc) => doc.data())[0];\n  if (!song) {\n    ctx.response.status = 404;\n    ctx.response.body = `The song titled "${ctx.params.title}" was not found.`;\n    ctx.response.type = "text";\n  } else {\n    ctx.response.body = querySnapshot.docs.map((doc) => doc.data())[0];\n    ctx.response.type = "json";\n  }\n});\n\nfunction isSong(value) {\n  return typeof value === "object" && value !== null && "title" in value;\n}\n\n// Removes any songs with the same title and adds the new song\nrouter.post("/songs", async (ctx) => {\n  const body = ctx.request.body();\n  if (body.type !== "json") {\n    ctx.throw(Status.BadRequest, "Must be a JSON document");\n  }\n  const song = await body.value;\n  if (!isSong(song)) {\n    ctx.throw(Status.BadRequest, "Payload was not well formed");\n  }\n  const querySnapshot = await db\n    .collection("songs")\n    .where("title", "==", song.title)\n    .get();\n  await Promise.all(querySnapshot.docs.map((doc) => doc.ref.delete()));\n  const songsRef = db.collection("songs");\n  await songsRef.add(song);\n  ctx.response.status = Status.NoContent;\n});\n')),(0,i.kt)("p",null,"Ok, we are almost done. We just need to create our middleware application, and\nadd the ",(0,i.kt)("inlineCode",{parentName:"p"},"localStorage")," middleware we imported:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const app = new Application();\napp.use(virtualStorage());\n")),(0,i.kt)("p",null,"And then we need to add middleware to authenticate the user. In this tutorial we\nare simply grabbing the username and password from the environment variables we\nwill be setting up, but this could easily be adapted to redirect a user to a\nsign-in page if they are not logged in:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'app.use(async (ctx, next) => {\n  const signedInUid = ctx.cookies.get("LOGGED_IN_UID");\n  const signedInUser = signedInUid != null ? users.get(signedInUid) : undefined;\n  if (!signedInUid || !signedInUser || !auth.currentUser) {\n    const creds = await auth.signInWithEmailAndPassword(\n      Deno.env.get("FIREBASE_USERNAME"),\n      Deno.env.get("FIREBASE_PASSWORD"),\n    );\n    const { user } = creds;\n    if (user) {\n      users.set(user.uid, user);\n      ctx.cookies.set("LOGGED_IN_UID", user.uid);\n    } else if (signedInUser && signedInUid.uid !== auth.currentUser?.uid) {\n      await auth.updateCurrentUser(signedInUser);\n    }\n  }\n  return next();\n});\n')),(0,i.kt)("p",null,"Now let's add our router to the middleware application and set the application\nto listen on port 8000:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"app.use(router.routes());\napp.use(router.allowedMethods());\nawait app.listen({ port: 8000 });\n")),(0,i.kt)("p",null,"Now we have an application that should serve up our APIs."),(0,i.kt)("h2",{id:"create-a-project-in-deno-deploy"},"Create a Project in Deno Deploy"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to ",(0,i.kt)("a",{parentName:"p",href:"https://dash.deno.com/new"},"https://dash.deno.com/new")," (Sign in with\nGitHub if you didn't already) and click on ",(0,i.kt)("strong",{parentName:"p"},"+ Empty Project")," under ",(0,i.kt)("strong",{parentName:"p"},"Deploy\nfrom the command line"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Now click on ",(0,i.kt)("strong",{parentName:"p"},"Settings")," button available on the project page.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to ",(0,i.kt)("strong",{parentName:"p"},"Environment Variables")," Section and add the following:"),(0,i.kt)("dl",null,(0,i.kt)("dt",null,(0,i.kt)("code",null,"FIREBASE_USERNAME")),(0,i.kt)("dd",null,"The Firebase user (email address) that was added above."),(0,i.kt)("dt",null,(0,i.kt)("code",null,"FIREBASE_PASSWORD")),(0,i.kt)("dd",null,"The Firebase user password that was added above."),(0,i.kt)("dt",null,(0,i.kt)("code",null,"FIREBASE_CONFIG")),(0,i.kt)("dd",null,"The configuration of the Firebase application as a JSON string.")))),(0,i.kt)("p",null,"The configuration needs to be a valid JSON string to be readable by the\napplication. If the code snippet given when setting up looked like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'var firebaseConfig = {\n  apiKey: "APIKEY",\n  authDomain: "example-12345.firebaseapp.com",\n  projectId: "example-12345",\n  storageBucket: "example-12345.appspot.com",\n  messagingSenderId: "1234567890",\n  appId: "APPID",\n};\n')),(0,i.kt)("p",null,"You would need to set the value of the string to this (noting that spacing and\nnew lines are not required):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "apiKey": "APIKEY",\n  "authDomain": "example-12345.firebaseapp.com",\n  "projectId": "example-12345",\n  "storageBucket": "example-12345.appspot.com",\n  "messagingSenderId": "1234567890",\n  "appId": "APPID"\n}\n')),(0,i.kt)("h2",{id:"deploy-the-application"},"Deploy the application"),(0,i.kt)("p",null,"Now let's deploy the application:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to ",(0,i.kt)("a",{parentName:"p",href:"https://gist.github.com/new"},"https://gist.github.com/new")," and create a new gist, ensuring the\nfilename of the gist ends with ",(0,i.kt)("inlineCode",{parentName:"p"},".js"),"."),(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},"For convenience the whole application is hosted at\n",(0,i.kt)("a",{parentName:"p",href:"https://deno.com/examples/firebase.js"},"https://deno.com/examples/firebase.js"),". You can skip creating a gist if you\nwant to try the example without any modification, or click the link at the\nbottom of the tutorial."))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Copy the ",(0,i.kt)("em",{parentName:"p"},"Raw")," link of the saved gist.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In your project on ",(0,i.kt)("inlineCode",{parentName:"p"},"dash.deno.com"),", click the ",(0,i.kt)("strong",{parentName:"p"},"Deploy URL")," button and enter\nthe link to the raw gist in the URL field.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click the ",(0,i.kt)("strong",{parentName:"p"},"Deploy")," button and copy one of the URLs displayed in the\n",(0,i.kt)("strong",{parentName:"p"},"Domains")," section of the project panel."))),(0,i.kt)("p",null,"Now let's take our API for a spin."),(0,i.kt)("p",null,"We can create a new song:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'curl --request POST \\\n  --header "Content-Type: application/json" \\\n  --data \'{"title": "Old Town Road", "artist": "Lil Nas X", "album": "7", "released": "2019", "genres": "Country rap, Pop"}\' \\\n  --dump-header \\\n  - https://<project_name>.deno.dev/songs\n')),(0,i.kt)("p",null,"And we can get all the songs in our collection:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"curl https://<project_name>.deno.dev/songs\n")),(0,i.kt)("p",null,"And we get specific information about a title we created:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"curl https://<project_name>.deno.dev/songs/Old%20Town%20Road\n")),(0,i.kt)("hr",null),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://dash.deno.com/new?url=https://deno.com/examples/firebase.js&env=FIREBASE_USERNAME,FIREBASE_PASSWORD,FIREBASE_CONFIG"},(0,i.kt)("img",{alt:"Deploy this example",src:n(88183).Z,width:"105",height:"36"}))))}d.isMDXComponent=!0},88183:(e,t,n)=>{n.d(t,{Z:()=>a});const a="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA1IiBoZWlnaHQ9IjM2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxyZWN0IHdpZHRoPSIxMDUiIGhlaWdodD0iMzYiIHJ4PSI0IiBmaWxsPSIjMDAwIi8+CiAgPHBhdGggZD0iTTIzLjY0IDI0LjYyYzEuMDYgMCAyLjAxLS4yMiAyLjg1LS42Ny44NS0uNDUgMS41MS0xLjEgMi0xLjk0LjUtLjg2Ljc1LTEuODguNzUtMy4wN1Y5aC0xLjk3djYuNTVoLS4wNWE0LjUzIDQuNTMgMCAwMC0zLjktMi4xN2MtMSAwLTEuOTEuMjItMi43Mi42N2E0Ljk3IDQuOTcgMCAwMC0xLjkxIDEuOTIgNS44NCA1Ljg0IDAgMDAtLjY5IDIuOWMwIDEuMTguMjQgMi4yLjcgMy4wOGE1LjA2IDUuMDYgMCAwMDIgMS45OGMuODYuNDYgMS44NC43IDIuOTQuN3ptMC0xLjY2Yy0uNjcgMC0xLjI5LS4xNi0xLjg0LS40OWEzLjU4IDMuNTggMCAwMS0xLjMxLTEuMzZjLS4zMy0uNi0uNS0xLjMtLjUtMi4xMSAwLS43OS4xNi0xLjQ3LjQ4LTIuMDZhMy41IDMuNSAwIDAxMy4xNS0xLjkgMy41IDMuNSAwIDAxMy4xMyAxLjg4Yy4zMy41OS41IDEuMjkuNSAyLjEgMCAuOC0uMTcgMS41LS41IDIuMDlhMy40MyAzLjQzIDAgMDEtMy4xIDEuODV6TTM3Ljg1IDI0LjM3YTcuNTEgNy41MSAwIDAxLTMuMjEtLjY1IDUuMzggNS4zOCAwIDAxLTIuMTctMS44OEE1LjIgNS4yIDAgMDEzMS43IDE5YzAtMS4wNy4yMi0yLjAyLjY2LTIuODZhNS4wOSA1LjA5IDAgMDExLjg1LTIuMDJjLjc4LS41IDEuNy0uNzQgMi43NC0uNzRhNS4xIDUuMSAwIDAxMi44MS43MSA0LjQgNC40IDAgMDExLjcgMS45NCA2LjMyIDYuMzIgMCAwMS41IDMuNjJIMzMuOGEzLjE3IDMuMTcgMCAwMDIuMDggMi43MmMuNTkuMjIgMS4yMy4zNCAxLjkzLjM0aDIuODV2MS42NmgtMi44em0tNC4wNy02LjA5aDYuMjRjMC0uNDYtLjEtLjk0LS4yOC0xLjQ1LS4xOC0uNS0uNS0uOTMtLjk0LTEuMjhhMi44MiAyLjgyIDAgMDAtMS44NS0uNTVjLS42NSAwLTEuMjIuMTctMS43LjUtLjQ1LjMzLS44Ljc0LTEuMDYgMS4yNS0uMjUuNDktLjM4IDEtLjQxIDEuNTN6TTUwLjA3IDEzLjM4Yy0xLjA2IDAtMi4wMS4yMi0yLjg2LjY3YTUuMDYgNS4wNiAwIDAwLTIuMDEgMS45NiA2IDYgMCAwMC0uNzMgMy4wNVYyOWgxLjk3di02LjU1aC4wNGMuMzYuNjUuOSAxLjE3IDEuNiAxLjU4LjcuNCAxLjQ2LjYgMi4zLjYgMSAwIDEuOTEtLjIzIDIuNzEtLjY4YTQuODIgNC44MiAwIDAwMS45LTEuOWMuNDgtLjgzLjcyLTEuOC43Mi0yLjkyIDAtMS4xOC0uMjUtMi4yLS43My0zLjA2YTQuODUgNC44NSAwIDAwLTItMiA1Ljk2IDUuOTYgMCAwMC0yLjkxLS43em0wIDEuNjZhMy41IDMuNSAwIDAxMy4xNSAxLjg1Yy4zMy42LjUgMS4zLjUgMi4xMSAwIC43OS0uMTcgMS40Ny0uNSAyLjA2YTMuNTMgMy41MyAwIDAxLTMuMTMgMS45Yy0uNjcgMC0xLjI5LS4xNi0xLjg1LS40OWEzLjU4IDMuNTggMCAwMS0xLjMtMS4zNiA0LjU0IDQuNTQgMCAwMS0uNDgtMi4xM2MwLS44LjE2LTEuNS40Ny0yLjA5YTMuNSAzLjUgMCAwMTMuMTMtMS44NXpNNTguMjMgMjQuMzdWOWgxLjk3djE1LjM3aC0xLjk3ek02OC40OSAyNC42MmMtMS4xMiAwLTIuMS0uMjQtMi45OC0uNzRhNS42OSA1LjY5IDAgMDEtMi4wNC0yLjAyIDUuNyA1LjcgMCAwMS0uNzMtMi44NiA1LjQ3IDUuNDcgMCAwMTIuNzctNC44NmMuODctLjUgMS44Ni0uNzYgMi45OC0uNzZhNS43MiA1LjcyIDAgMDE1IDIuNzhjLjUuODQuNzUgMS43OS43NSAyLjg0YTUuNTcgNS41NyAwIDAxLTIuNzkgNC44OGMtLjg2LjUtMS44NC43NC0yLjk2Ljc0em0wLTEuNjZhMy42MyAzLjYzIDAgMDAzLjI4LTEuOTRjLjMyLS42LjQ3LTEuMjguNDctMi4wMnMtLjE1LTEuNDEtLjQ3LTJhMy42NSAzLjY1IDAgMDAtMS4zLTEuNDMgMy42MyAzLjYzIDAgMDAtMS45OC0uNTNjLS43NCAwLTEuNC4xOC0xLjk3LjUzLS41Ni4zNS0xIC44My0xLjMxIDEuNDNhNC4xOCA0LjE4IDAgMDAtLjQ3IDJjMCAuNzQuMTUgMS40Mi40NyAyLjAyLjMxLjU5Ljc1IDEuMDYgMS4zIDEuNDFhMy43IDMuNyAwIDAwMS45OC41M3pNODAuOSAyOC42NHYtNC4xYTUuMDYgNS4wNiAwIDAxLTIuMTQtLjggNC41OCA0LjU4IDAgMDEtMi0zLjl2LTYuMmgydjYuMThjMCAuNjUuMTUgMS4yLjQzIDEuNjlhMy4xMiAzLjEyIDAgMDAyLjY4IDEuNDUgMy4yMiAzLjIyIDAgMDAyLjctMS40NWMuMy0uNDguNDYtMS4wNC40Ni0xLjY5di02LjE5SDg3djYuMjFhNC43IDQuNyAwIDAxLS41NCAyLjI4Yy0uMzQuNjYtLjgzIDEuMi0xLjQ1IDEuNjItLjYyLjQtMS4zMy42Ny0yLjEzLjh2NC4xaC0xLjk3eiIgZmlsbD0iI2ZmZiIvPgogIDxyZWN0IHdpZHRoPSIxMDUiIGhlaWdodD0iMzYiIHJ4PSI0IiBmaWxsPSIjMDAwIi8+CiAgPHBhdGggZD0iTTIzLjY0IDI1LjYyYzEuMDYgMCAyLjAxLS4yMiAyLjg1LS42Ny44NS0uNDUgMS41MS0xLjEgMi0xLjk0LjUtLjg2Ljc1LTEuODguNzUtMy4wN1YxMGgtMS45N3Y2LjU1aC0uMDVhNC41MyA0LjUzIDAgMDAtMy45LTIuMTdjLTEgMC0xLjkxLjIyLTIuNzIuNjdhNC45NyA0Ljk3IDAgMDAtMS45MSAxLjkyIDUuODQgNS44NCAwIDAwLS42OSAyLjljMCAxLjE4LjI0IDIuMi43IDMuMDhhNS4wNiA1LjA2IDAgMDAyIDEuOThjLjg2LjQ2IDEuODQuNyAyLjk0Ljd6bTAtMS42NmMtLjY3IDAtMS4yOS0uMTYtMS44NC0uNDlhMy41OCAzLjU4IDAgMDEtMS4zMS0xLjM2Yy0uMzMtLjYtLjUtMS4zLS41LTIuMTEgMC0uNzkuMTYtMS40Ny40OC0yLjA2YTMuNSAzLjUgMCAwMTMuMTUtMS45IDMuNSAzLjUgMCAwMTMuMTMgMS44OGMuMzMuNTkuNSAxLjI5LjUgMi4xIDAgLjgtLjE3IDEuNS0uNSAyLjA5YTMuNDMgMy40MyAwIDAxLTMuMSAxLjg1ek0zNy44NSAyNS4zN2E3LjUxIDcuNTEgMCAwMS0zLjIxLS42NSA1LjM4IDUuMzggMCAwMS0yLjE3LTEuODhBNS4yIDUuMiAwIDAxMzEuNyAyMGMwLTEuMDcuMjItMi4wMi42Ni0yLjg2YTUuMDkgNS4wOSAwIDAxMS44NS0yLjAyYy43OC0uNSAxLjctLjc0IDIuNzQtLjc0YTUuMSA1LjEgMCAwMTIuODEuNzEgNC40IDQuNCAwIDAxMS43IDEuOTQgNi4zMiA2LjMyIDAgMDEuNSAzLjYySDMzLjhhMy4xNyAzLjE3IDAgMDAyLjA4IDIuNzJjLjU5LjIyIDEuMjMuMzQgMS45My4zNGgyLjg1djEuNjZoLTIuOHptLTQuMDctNi4wOWg2LjI0YzAtLjQ2LS4xLS45NC0uMjgtMS40NS0uMTgtLjUtLjUtLjkzLS45NC0xLjI4YTIuODIgMi44MiAwIDAwLTEuODUtLjU1Yy0uNjUgMC0xLjIyLjE3LTEuNy41LS40NS4zMy0uOC43NC0xLjA2IDEuMjUtLjI1LjQ5LS4zOCAxLS40MSAxLjUzek01MC4wNyAxNC4zOGMtMS4wNiAwLTIuMDEuMjItMi44Ni42N2E1LjA2IDUuMDYgMCAwMC0yLjAxIDEuOTYgNiA2IDAgMDAtLjczIDMuMDVWMzBoMS45N3YtNi41NWguMDRjLjM2LjY1LjkgMS4xNyAxLjYgMS41OC43LjQgMS40Ni42IDIuMy42IDEgMCAxLjkxLS4yMyAyLjcxLS42OGE0LjgyIDQuODIgMCAwMDEuOS0xLjljLjQ4LS44My43Mi0xLjguNzItMi45MiAwLTEuMTgtLjI1LTIuMi0uNzMtMy4wNmE0Ljg1IDQuODUgMCAwMC0yLTIgNS45NiA1Ljk2IDAgMDAtMi45MS0uN3ptMCAxLjY2YTMuNSAzLjUgMCAwMTMuMTUgMS44NWMuMzMuNi41IDEuMy41IDIuMTEgMCAuNzktLjE3IDEuNDctLjUgMi4wNmEzLjUzIDMuNTMgMCAwMS0zLjEzIDEuOWMtLjY3IDAtMS4yOS0uMTYtMS44NS0uNDlhMy41OCAzLjU4IDAgMDEtMS4zLTEuMzYgNC41NCA0LjU0IDAgMDEtLjQ4LTIuMTNjMC0uOC4xNi0xLjUuNDctMi4wOWEzLjUgMy41IDAgMDEzLjEzLTEuODV6TTU4LjIzIDI1LjM3VjEwaDEuOTd2MTUuMzdoLTEuOTd6TTY4LjQ5IDI1LjYyYy0xLjEyIDAtMi4xLS4yNC0yLjk4LS43NGE1LjY5IDUuNjkgMCAwMS0yLjA0LTIuMDIgNS43IDUuNyAwIDAxLS43My0yLjg2IDUuNDcgNS40NyAwIDAxMi43Ny00Ljg2Yy44Ny0uNSAxLjg2LS43NiAyLjk4LS43NmE1LjcyIDUuNzIgMCAwMTUgMi43OGMuNS44NC43NSAxLjc5Ljc1IDIuODRhNS41NyA1LjU3IDAgMDEtMi43OSA0Ljg4Yy0uODYuNS0xLjg0Ljc0LTIuOTYuNzR6bTAtMS42NmEzLjYzIDMuNjMgMCAwMDMuMjgtMS45NGMuMzItLjYuNDctMS4yOC40Ny0yLjAycy0uMTUtMS40MS0uNDctMmEzLjY1IDMuNjUgMCAwMC0xLjMtMS40MyAzLjYzIDMuNjMgMCAwMC0xLjk4LS41M2MtLjc0IDAtMS40LjE4LTEuOTcuNTMtLjU2LjM1LTEgLjgzLTEuMzEgMS40M2E0LjE4IDQuMTggMCAwMC0uNDcgMmMwIC43NC4xNSAxLjQyLjQ3IDIuMDIuMzEuNTkuNzUgMS4wNiAxLjMgMS40MWEzLjcgMy43IDAgMDAxLjk4LjUzek04MC45IDI5LjY0di00LjFhNS4wNiA1LjA2IDAgMDEtMi4xNC0uOCA0LjU4IDQuNTggMCAwMS0yLTMuOXYtNi4yaDJ2Ni4xOGMwIC42NS4xNSAxLjIuNDMgMS42OWEzLjEyIDMuMTIgMCAwMDIuNjggMS40NSAzLjIyIDMuMjIgMCAwMDIuNy0xLjQ1Yy4zLS40OC40Ni0xLjA0LjQ2LTEuNjl2LTYuMTlIODd2Ni4yMWE0LjcgNC43IDAgMDEtLjU0IDIuMjhjLS4zNC42Ni0uODMgMS4yLTEuNDUgMS42Mi0uNjIuNC0xLjMzLjY3LTIuMTMuOHY0LjFoLTEuOTd6IiBmaWxsPSIjZmZmIi8+Cjwvc3ZnPgo="}}]);